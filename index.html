<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">

<link rel="icon" type="image/png" href="favicon.png">

<!-- ★ ブラウザズーム完全禁止 -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<title>イシダテックパンフレット</title>

<style>
  body {
    margin: 0;
    font-family: sans-serif;
    text-align: center;
    overflow: hidden;
    touch-action: none; /* ★ 暗黙ズーム防止 */
  }

  h2 { margin: 8px 0; }

  .controls { margin: 8px 0; }

  button {
    padding: 8px 16px;
    font-size: 16px;
    margin: 0 10px;
  }

  .stage {
    width: 100vw;
    height: calc(100vh - 120px);
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    background: #f5f5f5;
  }

  .scale-wrapper {
    transform-origin: center center;
  }

  .viewer {
    display: flex;
    gap: 0;
    cursor: grab;
    user-select: none;
  }

  .viewer:active { cursor: grabbing; }

  .viewer img {
    display: block;
  }

  .border img {
    border: 2px solid #bbb;
  }
</style>
</head>
<body>

<h2>イシダテックパンフレット</h2>

<div class="controls">
  <button onclick="prev()">◀ 戻る</button>
  <button onclick="next()">進む ▶</button>
</div>

<div class="stage">
  <div id="scaleWrapper" class="scale-wrapper">
    <div id="viewer" class="viewer"></div>
  </div>
</div>

<script>
  const sequence = [
    ['01.png'],
    ['02.png', '03.png'],
    ['04.png', '05.png', '06.png', '07.png'],
    ['08.png']
  ];

  let index = 0;
  let offsetX = 0;
  let startX = 0;
  let dragging = false;

  const viewer = document.getElementById('viewer');
  const scaleWrapper = document.getElementById('scaleWrapper');

  function render() {
    viewer.innerHTML = '';
    viewer.className = 'viewer';
    offsetX = 0;
    viewer.style.transform = 'translateX(0px)';

    const pages = sequence[index];
    if (pages.length === 1) viewer.classList.add('border');

    let loaded = 0;

    pages.forEach(p => {
      const img = document.createElement('img');
      img.src = p;

      img.onload = () => {
        loaded++;
        if (loaded === pages.length) {
          fitToScreen(); // ★ 全画像読込後に一度だけ実行
        }
      };

      viewer.appendChild(img);
    });
  }

  function fitToScreen() {
    const stage = document.querySelector('.stage');

    const stageW = stage.clientWidth;
    const stageH = stage.clientHeight;

    const viewerW = viewer.scrollWidth;
    const viewerH = viewer.scrollHeight;

    let scale = Math.min(stageW / viewerW, stageH / viewerH);

    if (scale > 1) scale = 1; // ★ 拡大禁止

    scaleWrapper.style.transform = `scale(${scale})`;
  }

  /* ドラッグ */
  viewer.addEventListener('mousedown', e => {
    dragging = true;
    startX = e.clientX - offsetX;
  });

  window.addEventListener('mousemove', e => {
    if (!dragging) return;
    offsetX = e.clientX - startX;
    viewer.style.transform = `translateX(${offsetX}px)`;
  });

  window.addEventListener('mouseup', () => dragging = false);

  /* タッチ */
  viewer.addEventListener('touchstart', e => {
    dragging = true;
    startX = e.touches[0].clientX - offsetX;
  });

  viewer.addEventListener('touchmove', e => {
    if (!dragging) return;
    offsetX = e.touches[0].clientX - startX;
    viewer.style.transform = `translateX(${offsetX}px)`;
  });

  viewer.addEventListener('touchend', () => dragging = false);

  function next() {
    if (index < sequence.length - 1) {
      index++;
      render();
    }
  }

  function prev() {
    if (index > 0) {
      index--;
      render();
    }
  }

  render();
</script>

</body>
</html>
